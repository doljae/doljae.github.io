---
slug: 31
title: "대규모 서비스를 지탱하는 기술 04"
authors: seokjae
tags: ["tistory"]
enableComments: true
keywords: ["tistory"]
date: 2021-01-12T17:45:52+09:00
---

> 원문: https://doljae.tistory.com/31

### 클라우드의 장단점

#### 장점

확장의 유연성

<!-- truncate -->

저가로 사용하면서 확장해나갈 수 있다.

#### 단점

획일적인 호스트 사양(메모리 상한선, 느린 I/O)

애매한 로드밸런서

때때로 멈춘다

### 자체 구축 인프라의 장단점

#### 장점

하드웨어 구성을 유연하게 할 수 있다.

서비스로부터의 요청에 유연하게 대응할 수 있다.

병목현상을 제어할 수 있다.

### 다중성 확보

#### 원리

서버를 여러 대 늘어놓는다.

1, 2대 정지하더라도 충분히 처리할 수 있도록 해둔다.

로드밸런서로 페일오버 / 페일백

#### 멀티 마스터

VRRP(Virtual Router Redundancy Protocol) 기반으로 감시하면서 다중의 마스터를 두는 MySQL 기법

Active 마스터와 Stanby 마스터를 운용해 Active 마스터에 장애가 나면 Stanby 마스터를 Active 마스터로 승격시켜서 서비스를 지속하는 방법.

전환 타이밍에 따라 동기가 맞지 않을 위험성이 있다.

### 시스템의 불안정 요인

1\. 기능 추가

2\. 메모리 누수

3\. 지뢰

4\. 사용자의 액세스 패턴

5\. 데이터량 증가

6\. 외부연계 추가

7\. 메모리, HDD 장애

8\. NIC(Network Interface Card) 장애

#### 대책

1\. 적절한 여유(버퍼) 유지

메모리, CPU 등을 한계의 7할 정도로 운용한다

2\. 불안정 요인 제거

예를 들어 부하가 높은 SQL을 필요로 하는 경우애는 별도 호스트로 메모리 누수를 줄인다

3\. 이상 동작 시 자율 제어

자동 DoS 판정(mod\_dosdetector)

자동 재시작(AP 서버, 호스트 , OS)

자동 쿼리 제거(소요 시간이 긴 SQL을 KILL)

#### 포워드 프락시 vs 리버스 프락시

추후 기술
